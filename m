Return-Path: <linux-kselftest+bounces-25847-lists+linux-kselftest=lfdr.de@vger.kernel.org>
X-Original-To: lists+linux-kselftest@lfdr.de
Delivered-To: lists+linux-kselftest@lfdr.de
Received: from sy.mirrors.kernel.org (sy.mirrors.kernel.org [IPv6:2604:1380:40f1:3f00::1])
	by mail.lfdr.de (Postfix) with ESMTPS id 33D96A28B75
	for <lists+linux-kselftest@lfdr.de>; Wed,  5 Feb 2025 14:16:48 +0100 (CET)
Received: from smtp.subspace.kernel.org (relay.kernel.org [52.25.139.140])
	(using TLSv1.2 with cipher ECDHE-ECDSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by sy.mirrors.kernel.org (Postfix) with ESMTPS id 57C657A2F70
	for <lists+linux-kselftest@lfdr.de>; Wed,  5 Feb 2025 13:15:52 +0000 (UTC)
Received: from localhost.localdomain (localhost.localdomain [127.0.0.1])
	by smtp.subspace.kernel.org (Postfix) with ESMTP id 560571DE4EC;
	Wed,  5 Feb 2025 13:12:22 +0000 (UTC)
Authentication-Results: smtp.subspace.kernel.org;
	dkim=pass (2048-bit key) header.d=gmx.net header.i=ps.report@gmx.net header.b="mh+Ix1Fb"
X-Original-To: linux-kselftest@vger.kernel.org
Received: from mout.gmx.net (mout.gmx.net [212.227.15.19])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by smtp.subspace.kernel.org (Postfix) with ESMTPS id C22A21DDA15;
	Wed,  5 Feb 2025 13:12:16 +0000 (UTC)
Authentication-Results: smtp.subspace.kernel.org; arc=none smtp.client-ip=212.227.15.19
ARC-Seal:i=1; a=rsa-sha256; d=subspace.kernel.org; s=arc-20240116;
	t=1738761142; cv=none; b=YyFIrLp4AzFM2Uiqsh96+FvgEeiAM0fEPn0bqzGkK1ilyNWOFAf8XSeFy0nSWvLBzlZjYe90gplBY4NLyvMQpo6N+0HVsDr+9OZiJKVZHEBTn17jK5uE+iv83Z+UEqIqmb7NRfetJD4t8q+wiOTHG8XKP0XZ3L6GxLQIlzSqjqY=
ARC-Message-Signature:i=1; a=rsa-sha256; d=subspace.kernel.org;
	s=arc-20240116; t=1738761142; c=relaxed/simple;
	bh=Y/3V+emCRXVxI/5pFQD5uxe35BuduQQqfM0vaJoQW90=;
	h=From:To:Cc:Subject:Date:Message-ID:In-Reply-To:References:
	 MIME-Version; b=ZVx8P1yJCAuxpj9bIAAxHQIGQiOFYOJXy9mrRM20nqnO4ReLrRuw/N1UxE5hN/yOPSSuaK1NAfe+edv+5+u0MqGLeIVoirpbkozxyMK1+3n+5hDGEnVknfO2f/FaVydjkdbkawhOnaWURhCN/UPAcinjxo2ImYELjCf23GsNVGk=
ARC-Authentication-Results:i=1; smtp.subspace.kernel.org; dmarc=pass (p=quarantine dis=none) header.from=gmx.net; spf=pass smtp.mailfrom=gmx.net; dkim=pass (2048-bit key) header.d=gmx.net header.i=ps.report@gmx.net header.b=mh+Ix1Fb; arc=none smtp.client-ip=212.227.15.19
Authentication-Results: smtp.subspace.kernel.org; dmarc=pass (p=quarantine dis=none) header.from=gmx.net
Authentication-Results: smtp.subspace.kernel.org; spf=pass smtp.mailfrom=gmx.net
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmx.net;
	s=s31663417; t=1738761124; x=1739365924; i=ps.report@gmx.net;
	bh=Y/3V+emCRXVxI/5pFQD5uxe35BuduQQqfM0vaJoQW90=;
	h=X-UI-Sender-Class:From:To:Cc:Subject:Date:Message-ID:In-Reply-To:
	 References:MIME-Version:Content-Transfer-Encoding:cc:
	 content-transfer-encoding:content-type:date:from:message-id:
	 mime-version:reply-to:subject:to;
	b=mh+Ix1FbB/p91J/9vI+m2gz4NsMZFxcSRtf1jbWfgxUWnIQC/kjReXg9JAh11Ey7
	 DA+apPKK/yru2tjaKlAOAcRJKQaTZUPtcKQYvBAxQDZAePsGo2WAk5JNTsE42ePeA
	 8595IaaJ19It5kTT4r8o6kJcrQ3SoHM/bnL/8H9WeMsDdOVYM7G1tqvpPrgR7hAeE
	 2NisdBY61iS/wyLJ2llh2vWz0FtMpX/iGq8BHXeoTEC4jMi0Lv8KfU5Otwt5YkdXZ
	 YJT/nReTViwi3oR+1j+LZDsDjS1V2Za7eZ+5cJN+sTU6/L/HAyYSV0HM3aKQQStGb
	 i7QFA8Wv9DU7YrwgwA==
X-UI-Sender-Class: 724b4f7f-cbec-4199-ad4e-598c01a50d3a
Received: from localhost.fritz.box ([82.135.81.162]) by mail.gmx.net (mrgmx004
 [212.227.17.190]) with ESMTPSA (Nemesis) id 1Mt79P-1tQ47h2J6P-00yWWR; Wed, 05
 Feb 2025 14:12:04 +0100
From: Peter Seiderer <ps.report@gmx.net>
To: netdev@vger.kernel.org
Cc: linux-kernel@vger.kernel.org,
	linux-kselftest@vger.kernel.org,
	"David S . Miller" <davem@davemloft.net>,
	Eric Dumazet <edumazet@google.com>,
	Jakub Kicinski <kuba@kernel.org>,
	Paolo Abeni <pabeni@redhat.com>,
	Simon Horman <horms@kernel.org>,
	Shuah Khan <shuah@kernel.org>,
	Peter Seiderer <ps.report@gmx.net>
Subject: [PATCH net-next v4 13/17] net: pktgen: fix access outside of user given buffer in pktgen_if_write()
Date: Wed,  5 Feb 2025 14:11:49 +0100
Message-ID: <20250205131153.476278-14-ps.report@gmx.net>
X-Mailer: git-send-email 2.48.1
In-Reply-To: <20250205131153.476278-1-ps.report@gmx.net>
References: <20250205131153.476278-1-ps.report@gmx.net>
Precedence: bulk
X-Mailing-List: linux-kselftest@vger.kernel.org
List-Id: <linux-kselftest.vger.kernel.org>
List-Subscribe: <mailto:linux-kselftest+subscribe@vger.kernel.org>
List-Unsubscribe: <mailto:linux-kselftest+unsubscribe@vger.kernel.org>
MIME-Version: 1.0
Content-Transfer-Encoding: base64
X-Provags-ID: V03:K1:SmkqQ3zrOpXc+8olEgHqm882SrpP7wQOkYP4tkkHNS4GgN9NNgC
 hQ4NbxBwIrCi+iEJ1x+9Ab+s0K8wkAmEvyX+wELNuFojCdCQXj+Vdh91nwTvDYhoP5eov1x
 t1OgWgqIAMbBPiC2onED7ZyhpteW5dF5HY173D6ZRJj8pv9xu07txLw7DHhrHp3QISEaBrQ
 5lQW/tM3r3ezt+9wij2pQ==
X-Spam-Flag: NO
UI-OutboundReport: notjunk:1;M01:P0:sUX6qc/EFzs=;VqfxuZkf1FybBx6O1B649Mk7Po8
 VooJmF9N6pD5vrd1XeM7MKtgnSuNZPsBuyLpo4As6u0xHcOXGVM+OqW9AVr6gefYAzo26w+VO
 Kuh1UwmqnRhDPofP4RcPqnW+8MIBgblhI67lEskLb7I8ggqtmenv7tPy76VyeRtijDV6GS0qU
 jKZ0w70/SibJHgaDbyT505RCShQEvX4pfqCYu6u6saEejZxvg6iA0x9zotXyrKBMvCxC1Qdaa
 6NozZqAP+3wAoEPI5h+lJbvOINWOYC5oiAhvVFGm1TxmXMEuRRkRHp5FyD61hrdVdGwY/7H3P
 GGEIf8NMsLJmjd3viJGVwpiE0PnMQlp00ZXdXT+DHj83n0l+hxEmQ54BFHdnyf4hB9l2ry8DK
 1gVse58xVBELdMNS8DvRZzDXAXIcjMuUW+kBlIhooUGH0nbUcawCwW+/pWKMj1qQ/SfnDKiqk
 Ec3hOV2V3xKE5e53xvehBQtrCuuxP0mCiM6Ux5DGZHFaKD+IoJVn6WNUP6scwcsIR1cyyQZV6
 YseCZATiCK0HgTvxjSk2jSPA2HlU0Jvz2kVC3rBmT7dhmSpfI1NSotB1yUHB4nyxNLq/1wdEv
 rlPrRad5DcD0Cs4AQhq8a7NPBuVv6GmWcJHCCCKtwi/eDqLdc1mD7KZgbH7bzFO0143rsdT1b
 Iiz9izFVZ6aRIeN3eHyJ1qfdtNAGj023+JvYnU7NAjZKdVqpjN1XDcWOHtmsOv38/ITXKuNnv
 JxZGekCwsbRsx34EU3fsBaFuM/y+w9/iwufoyWrjKRp/Ph6aWxCFqmkfoCTdjCx3MPm1of8y4
 0DZ3I8bmNtogz5LE7mFkiaal4woU9Hr2BU/fRfF5fYdhKmRDvAGKNLaeoq4f7zbbzmNFPa4Ze
 7p6rA1XppOSGZvyGQ1bKr3JmH6RW1tU8dsBWPHEhkvc3WT/6mz/2ONmbPyIw7L/jnAQ9QgBiZ
 iyvJfsXB5wNgMfKcYcpPxGGrWCNQSvHKFWfoiwcY2ixZJPI/Co8bPUMWnyE84GBsrFNn0rtdR
 MFlBU/cOZKfEwOArLSg8ay8EPHtojMVswb/lCanqUP8uaVMH/HU3s7ZTJB+ldgvRpgl8gu992
 Rano5MTixRawad90YgauydiWOKAsL2qvVIGA6BxAfS8BTP/EzRqqTFCmiCuwVd3w4/2IZFwHs
 /G912xDFlYrfQ9s02rTDm200i6K1VTaHQo0N02dz+LDLSW/eSzOBAyjbw4Gzb4a2+Wk/XmSXs
 bBwPjzrkHqNolltUxwksQOgxX8GTahyAGWVRP61d2DZ2HjdiIK7unlIyn3UEmok3aWk9qQvNs
 FnZ7twIvNO7FwPI0rEB5FNgHGSVOGDz8acob2C0zwPxBkM=

SG9ub3VyIHRoZSB1c2VyIGdpdmVuIGJ1ZmZlciBzaXplIGZvciB0aGUgaGV4MzJfYXJnKCksIG51
bV9hcmcoKSwKc3Rybl9sZW4oKSwgZ2V0X2ltaXhfZW50cmllcygpIGFuZCBnZXRfbGFiZWxzKCkg
Y2FsbHMgKG90aGVyd2lzZSB0aGV5IHdpbGwKYWNjZXNzIG1lbW9yeSBvdXRzaWRlIG9mIHRoZSB1
c2VyIGdpdmVuIGJ1ZmZlcikuCgpTaWduZWQtb2ZmLWJ5OiBQZXRlciBTZWlkZXJlciA8cHMucmVw
b3J0QGdteC5uZXQ+Ci0tLQpDaGFuZ2VzIHYzIC0+IHY0OgogIC0gcmVwbGFjZSBDOTkgY29tbWVu
dCAoc3VnZ2VzdGVkIGJ5IFBhb2xvIEFiZW5pKQogIC0gZHJvcCBhdmFpbGFibGUgY2hhcmFjdGVy
cyBjaGVjayBpbiBzdHJuX2xlbigpIChzdWdnZXN0ZWQgYnkgUGFvbG8gQWJlbmkpCiAgLSBmYWN0
b3JlZCBvdXQgcGF0Y2ggJ25ldDogcGt0Z2VuOiBhbGlnbiBzb21lIHZhcmlhYmxlIGRlY2xhcmF0
aW9ucyB0byB0aGUKICAgIG1vc3QgY29tbW9uIHBhdHRlcm4nIChzdWdnZXN0ZWQgYnkgUGFvbG8g
QWJlbmkpCiAgLSBmYWN0b3JlZCBvdXQgcGF0Y2ggJ25ldDogcGt0Z2VuOiByZW1vdmUgZXh0cmEg
dG1wIHZhcmlhYmxlIChyZS11c2UgbGVuCiAgICBpbnN0ZWFkKScgKHN1Z2dlc3RlZCBieSBQYW9s
byBBYmVuaSkKICAtIGZhY3RvcmVkIG91dCBwYXRjaCAnbmV0OiBwa3RnZW46IHJlbW92ZSBzb21l
IHN1cGVyZmx1b3VzIHZhcmlhYmxlCiAgICBpbml0aWFsaXppbmcnIChzdWdnZXN0ZWQgYnkgUGFv
bG8gQWJlbmkpCiAgLSBmYWN0b3JlZCBvdXQgcGF0Y2ggJ25ldDogcGt0Z2VuOiBmaXggbXBscyBt
YXhpbXVtIGxhYmVscyBsaXN0IHBhcnNpbmcnCiAgICAoc3VnZ2VzdGVkIGJ5IFBhb2xvIEFiZW5p
KQogIC0gZmFjdG9yZWQgb3V0ICduZXQ6IHBrdGdlbjogaGV4MzJfYXJnL251bV9hcmcgZXJyb3Ig
b3V0IGluIGNhc2Ugbm8KICAgIGNoYXJhY3RlcnMgYXJlIGF2YWlsYWJsZScgKHN1Z2dlc3RlZCBi
eSBQYW9sbyBBYmVuaSkKICAtIGZhY3RvcmVkIG91dCAnbmV0OiBwa3RnZW46IG51bV9hcmcgZXJy
b3Igb3V0IGluIGNhc2Ugbm8gdmFsaWQgY2hhcmFjdGVyCiAgICBpcyBwYXJzZWQnIChzdWdnZXN0
ZWQgYnkgUGFvbG8gQWJlbmkpCgpDaGFuZ2VzIHYyIC0+IHYzOgogIC0gbm8gY2hhbmdlcwoKQ2hh
bmdlcyB2MSAtPiB2MjoKICAtIGFkZGl0aW9uYWwgZml4IGdldF9pbWl4X2VudHJpZXMoKSBhbmQg
Z2V0X2xhYmVscygpCi0tLQogbmV0L2NvcmUvcGt0Z2VuLmMgfCAxNzYgKysrKysrKysrKysrKysr
KysrKysrKysrKysrKysrLS0tLS0tLS0tLS0tLS0tLQogMSBmaWxlIGNoYW5nZWQsIDExNyBpbnNl
cnRpb25zKCspLCA1OSBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9uZXQvY29yZS9wa3RnZW4u
YyBiL25ldC9jb3JlL3BrdGdlbi5jCmluZGV4IDBmZDE1ZjIxMTE5Yi4uM2M0MmVjZjE3YmEyIDEw
MDY0NAotLS0gYS9uZXQvY29yZS9wa3RnZW4uYworKysgYi9uZXQvY29yZS9wa3RnZW4uYwpAQCAt
ODUxLDEwICs4NTEsMTEgQEAgc3RhdGljIGludCBzdHJuX2xlbihjb25zdCBjaGFyIF9fdXNlciAq
IHVzZXJfYnVmZmVyLCB1bnNpZ25lZCBpbnQgbWF4bGVuKQogICogInNpemUxLHdlaWdodF8xIHNp
emUyLHdlaWdodF8yIC4uLiBzaXplX24sd2VpZ2h0X24iIGZvciBleGFtcGxlLgogICovCiBzdGF0
aWMgaW50IGdldF9pbWl4X2VudHJpZXMoY29uc3QgY2hhciBfX3VzZXIgKmJ1ZmZlciwKKwkJCSAg
ICB1bnNpZ25lZCBpbnQgbWF4bGVuLAogCQkJICAgIHN0cnVjdCBwa3RnZW5fZGV2ICpwa3RfZGV2
KQogewogCWNoYXIgYzsKLQlpbnQgaSA9IDAsIGxlbjsKKwlpbnQgaSA9IDAsIG1heCwgbGVuOwog
CiAJcGt0X2Rldi0+bl9pbWl4X2VudHJpZXMgPSAwOwogCkBAIC04NjUsMTAgKzg2NiwxMyBAQCBz
dGF0aWMgaW50IGdldF9pbWl4X2VudHJpZXMoY29uc3QgY2hhciBfX3VzZXIgKmJ1ZmZlciwKIAkJ
aWYgKHBrdF9kZXYtPm5faW1peF9lbnRyaWVzID49IE1BWF9JTUlYX0VOVFJJRVMpCiAJCQlyZXR1
cm4gLUUyQklHOwogCi0JCWxlbiA9IG51bV9hcmcoJmJ1ZmZlcltpXSwgREVDXzEwX0RJR0lUUywg
JnNpemUpOworCQltYXggPSBtaW4oREVDXzEwX0RJR0lUUywgbWF4bGVuIC0gaSk7CisJCWxlbiA9
IG51bV9hcmcoJmJ1ZmZlcltpXSwgbWF4LCAmc2l6ZSk7CiAJCWlmIChsZW4gPCAwKQogCQkJcmV0
dXJuIGxlbjsKIAkJaSArPSBsZW47CisJCWlmIChpID49IG1heGxlbikKKwkJCXJldHVybiAtRUlO
VkFMOwogCQlpZiAoZ2V0X3VzZXIoYywgJmJ1ZmZlcltpXSkpCiAJCQlyZXR1cm4gLUVGQVVMVDsK
IAkJLyogQ2hlY2sgZm9yIGNvbW1hIGJldHdlZW4gc2l6ZV9pIGFuZCB3ZWlnaHRfaSAqLwpAQCAt
ODc5LDcgKzg4Myw4IEBAIHN0YXRpYyBpbnQgZ2V0X2ltaXhfZW50cmllcyhjb25zdCBjaGFyIF9f
dXNlciAqYnVmZmVyLAogCQlpZiAoc2l6ZSA8IDE0ICsgMjAgKyA4KQogCQkJc2l6ZSA9IDE0ICsg
MjAgKyA4OwogCi0JCWxlbiA9IG51bV9hcmcoJmJ1ZmZlcltpXSwgREVDXzEwX0RJR0lUUywgJndl
aWdodCk7CisJCW1heCA9IG1pbihERUNfMTBfRElHSVRTLCBtYXhsZW4gLSBpKTsKKwkJbGVuID0g
bnVtX2FyZygmYnVmZmVyW2ldLCBtYXgsICZ3ZWlnaHQpOwogCQlpZiAobGVuIDwgMCkKIAkJCXJl
dHVybiBsZW47CiAJCWlmICh3ZWlnaHQgPD0gMCkKQEAgLTg4OSwyMSArODk0LDIzIEBAIHN0YXRp
YyBpbnQgZ2V0X2ltaXhfZW50cmllcyhjb25zdCBjaGFyIF9fdXNlciAqYnVmZmVyLAogCQlwa3Rf
ZGV2LT5pbWl4X2VudHJpZXNbcGt0X2Rldi0+bl9pbWl4X2VudHJpZXNdLndlaWdodCA9IHdlaWdo
dDsKIAogCQlpICs9IGxlbjsKKwkJcGt0X2Rldi0+bl9pbWl4X2VudHJpZXMrKzsKKworCQlpZiAo
aSA+PSBtYXhsZW4pCisJCQlicmVhazsKIAkJaWYgKGdldF91c2VyKGMsICZidWZmZXJbaV0pKQog
CQkJcmV0dXJuIC1FRkFVTFQ7Ci0KIAkJaSsrOwotCQlwa3RfZGV2LT5uX2ltaXhfZW50cmllcysr
OwogCX0gd2hpbGUgKGMgPT0gJyAnKTsKIAogCXJldHVybiBpOwogfQogCi1zdGF0aWMgaW50IGdl
dF9sYWJlbHMoY29uc3QgY2hhciBfX3VzZXIgKmJ1ZmZlciwgc3RydWN0IHBrdGdlbl9kZXYgKnBr
dF9kZXYpCitzdGF0aWMgaW50IGdldF9sYWJlbHMoY29uc3QgY2hhciBfX3VzZXIgKmJ1ZmZlciwg
aW50IG1heGxlbiwgc3RydWN0IHBrdGdlbl9kZXYgKnBrdF9kZXYpCiB7CiAJY2hhciBjOwotCWlu
dCBpID0gMCwgbGVuOwogCXVuc2lnbmVkIGludCBuID0gMDsKKwlpbnQgaSA9IDAsIG1heCwgbGVu
OwogCiAJcGt0X2Rldi0+bnJfbGFiZWxzID0gMDsKIAlkbyB7CkBAIC05MTIsMTcgKzkxOSwyMCBA
QCBzdGF0aWMgaW50IGdldF9sYWJlbHMoY29uc3QgY2hhciBfX3VzZXIgKmJ1ZmZlciwgc3RydWN0
IHBrdGdlbl9kZXYgKnBrdF9kZXYpCiAJCWlmIChuID49IE1BWF9NUExTX0xBQkVMUykKIAkJCXJl
dHVybiAtRTJCSUc7CiAKLQkJbGVuID0gaGV4MzJfYXJnKCZidWZmZXJbaV0sIEhFWF84X0RJR0lU
UywgJnRtcCk7CisJCW1heCA9IG1pbihIRVhfOF9ESUdJVFMsIG1heGxlbiAtIGkpOworCQlsZW4g
PSBoZXgzMl9hcmcoJmJ1ZmZlcltpXSwgbWF4LCAmdG1wKTsKIAkJaWYgKGxlbiA8PSAwKQogCQkJ
cmV0dXJuIGxlbjsKIAkJcGt0X2Rldi0+bGFiZWxzW25dID0gaHRvbmwodG1wKTsKIAkJaWYgKHBr
dF9kZXYtPmxhYmVsc1tuXSAmIE1QTFNfU1RBQ0tfQk9UVE9NKQogCQkJcGt0X2Rldi0+ZmxhZ3Mg
fD0gRl9NUExTX1JORDsKIAkJaSArPSBsZW47CisJCW4rKzsKKwkJaWYgKGkgPj0gbWF4bGVuKQor
CQkJYnJlYWs7CiAJCWlmIChnZXRfdXNlcihjLCAmYnVmZmVyW2ldKSkKIAkJCXJldHVybiAtRUZB
VUxUOwogCQlpKys7Ci0JCW4rKzsKIAl9IHdoaWxlIChjID09ICcsJyk7CiAKIAlwa3RfZGV2LT5u
cl9sYWJlbHMgPSBuOwpAQCAtOTg2LDggKzk5Niw4IEBAIHN0YXRpYyBzc2l6ZV90IHBrdGdlbl9p
Zl93cml0ZShzdHJ1Y3QgZmlsZSAqZmlsZSwKIAlpID0gbGVuOwogCiAJLyogUmVhZCB2YXJpYWJs
ZSBuYW1lICovCi0KLQlsZW4gPSBzdHJuX2xlbigmdXNlcl9idWZmZXJbaV0sIHNpemVvZihuYW1l
KSAtIDEpOworCW1heCA9IG1pbihzaXplb2YobmFtZSkgLSAxLCBjb3VudCAtIGkpOworCWxlbiA9
IHN0cm5fbGVuKCZ1c2VyX2J1ZmZlcltpXSwgbWF4KTsKIAlpZiAobGVuIDwgMCkKIAkJcmV0dXJu
IGxlbjsKIApAQCAtMTAxNSw3ICsxMDI1LDggQEAgc3RhdGljIHNzaXplX3QgcGt0Z2VuX2lmX3dy
aXRlKHN0cnVjdCBmaWxlICpmaWxlLAogCX0KIAogCWlmICghc3RyY21wKG5hbWUsICJtaW5fcGt0
X3NpemUiKSkgewotCQlsZW4gPSBudW1fYXJnKCZ1c2VyX2J1ZmZlcltpXSwgREVDXzEwX0RJR0lU
UywgJnZhbHVlKTsKKwkJbWF4ID0gbWluKERFQ18xMF9ESUdJVFMsIGNvdW50IC0gaSk7CisJCWxl
biA9IG51bV9hcmcoJnVzZXJfYnVmZmVyW2ldLCBtYXgsICZ2YWx1ZSk7CiAJCWlmIChsZW4gPCAw
KQogCQkJcmV0dXJuIGxlbjsKIApAQCAtMTAzMiw3ICsxMDQzLDggQEAgc3RhdGljIHNzaXplX3Qg
cGt0Z2VuX2lmX3dyaXRlKHN0cnVjdCBmaWxlICpmaWxlLAogCX0KIAogCWlmICghc3RyY21wKG5h
bWUsICJtYXhfcGt0X3NpemUiKSkgewotCQlsZW4gPSBudW1fYXJnKCZ1c2VyX2J1ZmZlcltpXSwg
REVDXzEwX0RJR0lUUywgJnZhbHVlKTsKKwkJbWF4ID0gbWluKERFQ18xMF9ESUdJVFMsIGNvdW50
IC0gaSk7CisJCWxlbiA9IG51bV9hcmcoJnVzZXJfYnVmZmVyW2ldLCBtYXgsICZ2YWx1ZSk7CiAJ
CWlmIChsZW4gPCAwKQogCQkJcmV0dXJuIGxlbjsKIApAQCAtMTA1MSw3ICsxMDYzLDggQEAgc3Rh
dGljIHNzaXplX3QgcGt0Z2VuX2lmX3dyaXRlKHN0cnVjdCBmaWxlICpmaWxlLAogCS8qIFNob3J0
Y3V0IGZvciBtaW4gPSBtYXggKi8KIAogCWlmICghc3RyY21wKG5hbWUsICJwa3Rfc2l6ZSIpKSB7
Ci0JCWxlbiA9IG51bV9hcmcoJnVzZXJfYnVmZmVyW2ldLCBERUNfMTBfRElHSVRTLCAmdmFsdWUp
OworCQltYXggPSBtaW4oREVDXzEwX0RJR0lUUywgY291bnQgLSBpKTsKKwkJbGVuID0gbnVtX2Fy
ZygmdXNlcl9idWZmZXJbaV0sIG1heCwgJnZhbHVlKTsKIAkJaWYgKGxlbiA8IDApCiAJCQlyZXR1
cm4gbGVuOwogCkBAIC0xMDcxLDcgKzEwODQsOCBAQCBzdGF0aWMgc3NpemVfdCBwa3RnZW5faWZf
d3JpdGUoc3RydWN0IGZpbGUgKmZpbGUsCiAJCWlmIChwa3RfZGV2LT5jbG9uZV9za2IgPiAwKQog
CQkJcmV0dXJuIC1FSU5WQUw7CiAKLQkJbGVuID0gZ2V0X2ltaXhfZW50cmllcygmdXNlcl9idWZm
ZXJbaV0sIHBrdF9kZXYpOworCQltYXggPSBjb3VudCAtIGk7CisJCWxlbiA9IGdldF9pbWl4X2Vu
dHJpZXMoJnVzZXJfYnVmZmVyW2ldLCBtYXgsIHBrdF9kZXYpOwogCQlpZiAobGVuIDwgMCkKIAkJ
CXJldHVybiBsZW47CiAKQEAgLTEwODIsNyArMTA5Niw4IEBAIHN0YXRpYyBzc2l6ZV90IHBrdGdl
bl9pZl93cml0ZShzdHJ1Y3QgZmlsZSAqZmlsZSwKIAl9CiAKIAlpZiAoIXN0cmNtcChuYW1lLCAi
ZGVidWciKSkgewotCQlsZW4gPSBudW1fYXJnKCZ1c2VyX2J1ZmZlcltpXSwgREVDXzEwX0RJR0lU
UywgJnZhbHVlKTsKKwkJbWF4ID0gbWluKERFQ18xMF9ESUdJVFMsIGNvdW50IC0gaSk7CisJCWxl
biA9IG51bV9hcmcoJnVzZXJfYnVmZmVyW2ldLCBtYXgsICZ2YWx1ZSk7CiAJCWlmIChsZW4gPCAw
KQogCQkJcmV0dXJuIGxlbjsKIApAQCAtMTA5Myw3ICsxMTA4LDggQEAgc3RhdGljIHNzaXplX3Qg
cGt0Z2VuX2lmX3dyaXRlKHN0cnVjdCBmaWxlICpmaWxlLAogCX0KIAogCWlmICghc3RyY21wKG5h
bWUsICJmcmFncyIpKSB7Ci0JCWxlbiA9IG51bV9hcmcoJnVzZXJfYnVmZmVyW2ldLCBERUNfMTBf
RElHSVRTLCAmdmFsdWUpOworCQltYXggPSBtaW4oREVDXzEwX0RJR0lUUywgY291bnQgLSBpKTsK
KwkJbGVuID0gbnVtX2FyZygmdXNlcl9idWZmZXJbaV0sIG1heCwgJnZhbHVlKTsKIAkJaWYgKGxl
biA8IDApCiAJCQlyZXR1cm4gbGVuOwogCkBAIC0xMTAzLDcgKzExMTksOCBAQCBzdGF0aWMgc3Np
emVfdCBwa3RnZW5faWZfd3JpdGUoc3RydWN0IGZpbGUgKmZpbGUsCiAJCXJldHVybiBjb3VudDsK
IAl9CiAJaWYgKCFzdHJjbXAobmFtZSwgImRlbGF5IikpIHsKLQkJbGVuID0gbnVtX2FyZygmdXNl
cl9idWZmZXJbaV0sIERFQ18xMF9ESUdJVFMsICZ2YWx1ZSk7CisJCW1heCA9IG1pbihERUNfMTBf
RElHSVRTLCBjb3VudCAtIGkpOworCQlsZW4gPSBudW1fYXJnKCZ1c2VyX2J1ZmZlcltpXSwgbWF4
LCAmdmFsdWUpOwogCQlpZiAobGVuIDwgMCkKIAkJCXJldHVybiBsZW47CiAKQEAgLTExMTgsNyAr
MTEzNSw4IEBAIHN0YXRpYyBzc2l6ZV90IHBrdGdlbl9pZl93cml0ZShzdHJ1Y3QgZmlsZSAqZmls
ZSwKIAkJcmV0dXJuIGNvdW50OwogCX0KIAlpZiAoIXN0cmNtcChuYW1lLCAicmF0ZSIpKSB7Ci0J
CWxlbiA9IG51bV9hcmcoJnVzZXJfYnVmZmVyW2ldLCBERUNfMTBfRElHSVRTLCAmdmFsdWUpOwor
CQltYXggPSBtaW4oREVDXzEwX0RJR0lUUywgY291bnQgLSBpKTsKKwkJbGVuID0gbnVtX2FyZygm
dXNlcl9idWZmZXJbaV0sIG1heCwgJnZhbHVlKTsKIAkJaWYgKGxlbiA8IDApCiAJCQlyZXR1cm4g
bGVuOwogCkBAIC0xMTMzLDcgKzExNTEsOCBAQCBzdGF0aWMgc3NpemVfdCBwa3RnZW5faWZfd3Jp
dGUoc3RydWN0IGZpbGUgKmZpbGUsCiAJCXJldHVybiBjb3VudDsKIAl9CiAJaWYgKCFzdHJjbXAo
bmFtZSwgInJhdGVwIikpIHsKLQkJbGVuID0gbnVtX2FyZygmdXNlcl9idWZmZXJbaV0sIERFQ18x
MF9ESUdJVFMsICZ2YWx1ZSk7CisJCW1heCA9IG1pbihERUNfMTBfRElHSVRTLCBjb3VudCAtIGkp
OworCQlsZW4gPSBudW1fYXJnKCZ1c2VyX2J1ZmZlcltpXSwgbWF4LCAmdmFsdWUpOwogCQlpZiAo
bGVuIDwgMCkKIAkJCXJldHVybiBsZW47CiAKQEAgLTExNDgsNyArMTE2Nyw4IEBAIHN0YXRpYyBz
c2l6ZV90IHBrdGdlbl9pZl93cml0ZShzdHJ1Y3QgZmlsZSAqZmlsZSwKIAkJcmV0dXJuIGNvdW50
OwogCX0KIAlpZiAoIXN0cmNtcChuYW1lLCAidWRwX3NyY19taW4iKSkgewotCQlsZW4gPSBudW1f
YXJnKCZ1c2VyX2J1ZmZlcltpXSwgREVDXzEwX0RJR0lUUywgJnZhbHVlKTsKKwkJbWF4ID0gbWlu
KERFQ18xMF9ESUdJVFMsIGNvdW50IC0gaSk7CisJCWxlbiA9IG51bV9hcmcoJnVzZXJfYnVmZmVy
W2ldLCBtYXgsICZ2YWx1ZSk7CiAJCWlmIChsZW4gPCAwKQogCQkJcmV0dXJuIGxlbjsKIApAQCAt
MTE2MSw3ICsxMTgxLDggQEAgc3RhdGljIHNzaXplX3QgcGt0Z2VuX2lmX3dyaXRlKHN0cnVjdCBm
aWxlICpmaWxlLAogCQlyZXR1cm4gY291bnQ7CiAJfQogCWlmICghc3RyY21wKG5hbWUsICJ1ZHBf
ZHN0X21pbiIpKSB7Ci0JCWxlbiA9IG51bV9hcmcoJnVzZXJfYnVmZmVyW2ldLCBERUNfMTBfRElH
SVRTLCAmdmFsdWUpOworCQltYXggPSBtaW4oREVDXzEwX0RJR0lUUywgY291bnQgLSBpKTsKKwkJ
bGVuID0gbnVtX2FyZygmdXNlcl9idWZmZXJbaV0sIG1heCwgJnZhbHVlKTsKIAkJaWYgKGxlbiA8
IDApCiAJCQlyZXR1cm4gbGVuOwogCkBAIC0xMTc0LDcgKzExOTUsOCBAQCBzdGF0aWMgc3NpemVf
dCBwa3RnZW5faWZfd3JpdGUoc3RydWN0IGZpbGUgKmZpbGUsCiAJCXJldHVybiBjb3VudDsKIAl9
CiAJaWYgKCFzdHJjbXAobmFtZSwgInVkcF9zcmNfbWF4IikpIHsKLQkJbGVuID0gbnVtX2FyZygm
dXNlcl9idWZmZXJbaV0sIERFQ18xMF9ESUdJVFMsICZ2YWx1ZSk7CisJCW1heCA9IG1pbihERUNf
MTBfRElHSVRTLCBjb3VudCAtIGkpOworCQlsZW4gPSBudW1fYXJnKCZ1c2VyX2J1ZmZlcltpXSwg
bWF4LCAmdmFsdWUpOwogCQlpZiAobGVuIDwgMCkKIAkJCXJldHVybiBsZW47CiAKQEAgLTExODcs
NyArMTIwOSw4IEBAIHN0YXRpYyBzc2l6ZV90IHBrdGdlbl9pZl93cml0ZShzdHJ1Y3QgZmlsZSAq
ZmlsZSwKIAkJcmV0dXJuIGNvdW50OwogCX0KIAlpZiAoIXN0cmNtcChuYW1lLCAidWRwX2RzdF9t
YXgiKSkgewotCQlsZW4gPSBudW1fYXJnKCZ1c2VyX2J1ZmZlcltpXSwgREVDXzEwX0RJR0lUUywg
JnZhbHVlKTsKKwkJbWF4ID0gbWluKERFQ18xMF9ESUdJVFMsIGNvdW50IC0gaSk7CisJCWxlbiA9
IG51bV9hcmcoJnVzZXJfYnVmZmVyW2ldLCBtYXgsICZ2YWx1ZSk7CiAJCWlmIChsZW4gPCAwKQog
CQkJcmV0dXJuIGxlbjsKIApAQCAtMTIwMCw3ICsxMjIzLDggQEAgc3RhdGljIHNzaXplX3QgcGt0
Z2VuX2lmX3dyaXRlKHN0cnVjdCBmaWxlICpmaWxlLAogCQlyZXR1cm4gY291bnQ7CiAJfQogCWlm
ICghc3RyY21wKG5hbWUsICJjbG9uZV9za2IiKSkgewotCQlsZW4gPSBudW1fYXJnKCZ1c2VyX2J1
ZmZlcltpXSwgREVDXzEwX0RJR0lUUywgJnZhbHVlKTsKKwkJbWF4ID0gbWluKERFQ18xMF9ESUdJ
VFMsIGNvdW50IC0gaSk7CisJCWxlbiA9IG51bV9hcmcoJnVzZXJfYnVmZmVyW2ldLCBtYXgsICZ2
YWx1ZSk7CiAJCWlmIChsZW4gPCAwKQogCQkJcmV0dXJuIGxlbjsKIAkJLyogY2xvbmVfc2tiIGlz
IG5vdCBzdXBwb3J0ZWQgZm9yIG5ldGlmX3JlY2VpdmUgeG1pdF9tb2RlIGFuZApAQCAtMTIyMSw3
ICsxMjQ1LDggQEAgc3RhdGljIHNzaXplX3QgcGt0Z2VuX2lmX3dyaXRlKHN0cnVjdCBmaWxlICpm
aWxlLAogCQlyZXR1cm4gY291bnQ7CiAJfQogCWlmICghc3RyY21wKG5hbWUsICJjb3VudCIpKSB7
Ci0JCWxlbiA9IG51bV9hcmcoJnVzZXJfYnVmZmVyW2ldLCBERUNfMTBfRElHSVRTLCAmdmFsdWUp
OworCQltYXggPSBtaW4oREVDXzEwX0RJR0lUUywgY291bnQgLSBpKTsKKwkJbGVuID0gbnVtX2Fy
ZygmdXNlcl9idWZmZXJbaV0sIG1heCwgJnZhbHVlKTsKIAkJaWYgKGxlbiA8IDApCiAJCQlyZXR1
cm4gbGVuOwogCkBAIC0xMjMyLDcgKzEyNTcsOCBAQCBzdGF0aWMgc3NpemVfdCBwa3RnZW5faWZf
d3JpdGUoc3RydWN0IGZpbGUgKmZpbGUsCiAJCXJldHVybiBjb3VudDsKIAl9CiAJaWYgKCFzdHJj
bXAobmFtZSwgInNyY19tYWNfY291bnQiKSkgewotCQlsZW4gPSBudW1fYXJnKCZ1c2VyX2J1ZmZl
cltpXSwgREVDXzEwX0RJR0lUUywgJnZhbHVlKTsKKwkJbWF4ID0gbWluKERFQ18xMF9ESUdJVFMs
IGNvdW50IC0gaSk7CisJCWxlbiA9IG51bV9hcmcoJnVzZXJfYnVmZmVyW2ldLCBtYXgsICZ2YWx1
ZSk7CiAJCWlmIChsZW4gPCAwKQogCQkJcmV0dXJuIGxlbjsKIApAQCAtMTI0Niw3ICsxMjcyLDgg
QEAgc3RhdGljIHNzaXplX3QgcGt0Z2VuX2lmX3dyaXRlKHN0cnVjdCBmaWxlICpmaWxlLAogCQly
ZXR1cm4gY291bnQ7CiAJfQogCWlmICghc3RyY21wKG5hbWUsICJkc3RfbWFjX2NvdW50IikpIHsK
LQkJbGVuID0gbnVtX2FyZygmdXNlcl9idWZmZXJbaV0sIERFQ18xMF9ESUdJVFMsICZ2YWx1ZSk7
CisJCW1heCA9IG1pbihERUNfMTBfRElHSVRTLCBjb3VudCAtIGkpOworCQlsZW4gPSBudW1fYXJn
KCZ1c2VyX2J1ZmZlcltpXSwgbWF4LCAmdmFsdWUpOwogCQlpZiAobGVuIDwgMCkKIAkJCXJldHVy
biBsZW47CiAKQEAgLTEyNjAsNyArMTI4Nyw4IEBAIHN0YXRpYyBzc2l6ZV90IHBrdGdlbl9pZl93
cml0ZShzdHJ1Y3QgZmlsZSAqZmlsZSwKIAkJcmV0dXJuIGNvdW50OwogCX0KIAlpZiAoIXN0cmNt
cChuYW1lLCAiYnVyc3QiKSkgewotCQlsZW4gPSBudW1fYXJnKCZ1c2VyX2J1ZmZlcltpXSwgREVD
XzEwX0RJR0lUUywgJnZhbHVlKTsKKwkJbWF4ID0gbWluKERFQ18xMF9ESUdJVFMsIGNvdW50IC0g
aSk7CisJCWxlbiA9IG51bV9hcmcoJnVzZXJfYnVmZmVyW2ldLCBtYXgsICZ2YWx1ZSk7CiAJCWlm
IChsZW4gPCAwKQogCQkJcmV0dXJuIGxlbjsKIApAQCAtMTI3OSw3ICsxMzA3LDggQEAgc3RhdGlj
IHNzaXplX3QgcGt0Z2VuX2lmX3dyaXRlKHN0cnVjdCBmaWxlICpmaWxlLAogCQlyZXR1cm4gY291
bnQ7CiAJfQogCWlmICghc3RyY21wKG5hbWUsICJub2RlIikpIHsKLQkJbGVuID0gbnVtX2FyZygm
dXNlcl9idWZmZXJbaV0sIERFQ18xMF9ESUdJVFMsICZ2YWx1ZSk7CisJCW1heCA9IG1pbihERUNf
MTBfRElHSVRTLCBjb3VudCAtIGkpOworCQlsZW4gPSBudW1fYXJnKCZ1c2VyX2J1ZmZlcltpXSwg
bWF4LCAmdmFsdWUpOwogCQlpZiAobGVuIDwgMCkKIAkJCXJldHVybiBsZW47CiAKQEAgLTEzMDAs
MTEgKzEzMjksMTIgQEAgc3RhdGljIHNzaXplX3QgcGt0Z2VuX2lmX3dyaXRlKHN0cnVjdCBmaWxl
ICpmaWxlLAogCWlmICghc3RyY21wKG5hbWUsICJ4bWl0X21vZGUiKSkgewogCQljaGFyIGZbMzJd
OwogCi0JCW1lbXNldChmLCAwLCAzMik7Ci0JCWxlbiA9IHN0cm5fbGVuKCZ1c2VyX2J1ZmZlcltp
XSwgc2l6ZW9mKGYpIC0gMSk7CisJCW1heCA9IG1pbihzaXplb2YoZikgLSAxLCBjb3VudCAtIGkp
OworCQlsZW4gPSBzdHJuX2xlbigmdXNlcl9idWZmZXJbaV0sIG1heCk7CiAJCWlmIChsZW4gPCAw
KQogCQkJcmV0dXJuIGxlbjsKIAorCQltZW1zZXQoZiwgMCwgc2l6ZW9mKGYpKTsKIAkJaWYgKGNv
cHlfZnJvbV91c2VyKGYsICZ1c2VyX2J1ZmZlcltpXSwgbGVuKSkKIAkJCXJldHVybiAtRUZBVUxU
OwogCQlpICs9IGxlbjsKQEAgLTEzNDAsMTEgKzEzNzAsMTIgQEAgc3RhdGljIHNzaXplX3QgcGt0
Z2VuX2lmX3dyaXRlKHN0cnVjdCBmaWxlICpmaWxlLAogCQljaGFyIGZbMzJdOwogCQljaGFyICpl
bmQ7CiAKLQkJbWVtc2V0KGYsIDAsIDMyKTsKLQkJbGVuID0gc3Rybl9sZW4oJnVzZXJfYnVmZmVy
W2ldLCBzaXplb2YoZikgLSAxKTsKKwkJbWF4ID0gbWluKHNpemVvZihmKSAtIDEsIGNvdW50IC0g
aSk7CisJCWxlbiA9IHN0cm5fbGVuKCZ1c2VyX2J1ZmZlcltpXSwgbWF4KTsKIAkJaWYgKGxlbiA8
IDApCiAJCQlyZXR1cm4gbGVuOwogCisJCW1lbXNldChmLCAwLCAzMik7CiAJCWlmIChjb3B5X2Zy
b21fdXNlcihmLCAmdXNlcl9idWZmZXJbaV0sIGxlbikpCiAJCQlyZXR1cm4gLUVGQVVMVDsKIAkJ
aSArPSBsZW47CkBAIC0xMzg5LDcgKzE0MjAsOCBAQCBzdGF0aWMgc3NpemVfdCBwa3RnZW5faWZf
d3JpdGUoc3RydWN0IGZpbGUgKmZpbGUsCiAJCXJldHVybiBjb3VudDsKIAl9CiAJaWYgKCFzdHJj
bXAobmFtZSwgImRzdF9taW4iKSB8fCAhc3RyY21wKG5hbWUsICJkc3QiKSkgewotCQlsZW4gPSBz
dHJuX2xlbigmdXNlcl9idWZmZXJbaV0sIHNpemVvZihwa3RfZGV2LT5kc3RfbWluKSAtIDEpOwor
CQltYXggPSBtaW4oc2l6ZW9mKHBrdF9kZXYtPmRzdF9taW4pIC0gMSwgY291bnQgLSBpKTsKKwkJ
bGVuID0gc3Rybl9sZW4oJnVzZXJfYnVmZmVyW2ldLCBtYXgpOwogCQlpZiAobGVuIDwgMCkKIAkJ
CXJldHVybiBsZW47CiAKQEAgLTE0MDksNyArMTQ0MSw4IEBAIHN0YXRpYyBzc2l6ZV90IHBrdGdl
bl9pZl93cml0ZShzdHJ1Y3QgZmlsZSAqZmlsZSwKIAkJcmV0dXJuIGNvdW50OwogCX0KIAlpZiAo
IXN0cmNtcChuYW1lLCAiZHN0X21heCIpKSB7Ci0JCWxlbiA9IHN0cm5fbGVuKCZ1c2VyX2J1ZmZl
cltpXSwgc2l6ZW9mKHBrdF9kZXYtPmRzdF9tYXgpIC0gMSk7CisJCW1heCA9IG1pbihzaXplb2Yo
cGt0X2Rldi0+ZHN0X21heCkgLSAxLCBjb3VudCAtIGkpOworCQlsZW4gPSBzdHJuX2xlbigmdXNl
cl9idWZmZXJbaV0sIG1heCk7CiAJCWlmIChsZW4gPCAwKQogCQkJcmV0dXJuIGxlbjsKIApAQCAt
MTQyOSw3ICsxNDYyLDggQEAgc3RhdGljIHNzaXplX3QgcGt0Z2VuX2lmX3dyaXRlKHN0cnVjdCBm
aWxlICpmaWxlLAogCQlyZXR1cm4gY291bnQ7CiAJfQogCWlmICghc3RyY21wKG5hbWUsICJkc3Q2
IikpIHsKLQkJbGVuID0gc3Rybl9sZW4oJnVzZXJfYnVmZmVyW2ldLCBzaXplb2YoYnVmKSAtIDEp
OworCQltYXggPSBtaW4oc2l6ZW9mKGJ1ZikgLSAxLCBjb3VudCAtIGkpOworCQlsZW4gPSBzdHJu
X2xlbigmdXNlcl9idWZmZXJbaV0sIG1heCk7CiAJCWlmIChsZW4gPCAwKQogCQkJcmV0dXJuIGxl
bjsKIApAQCAtMTQ1Miw3ICsxNDg2LDggQEAgc3RhdGljIHNzaXplX3QgcGt0Z2VuX2lmX3dyaXRl
KHN0cnVjdCBmaWxlICpmaWxlLAogCQlyZXR1cm4gY291bnQ7CiAJfQogCWlmICghc3RyY21wKG5h
bWUsICJkc3Q2X21pbiIpKSB7Ci0JCWxlbiA9IHN0cm5fbGVuKCZ1c2VyX2J1ZmZlcltpXSwgc2l6
ZW9mKGJ1ZikgLSAxKTsKKwkJbWF4ID0gbWluKHNpemVvZihidWYpIC0gMSwgY291bnQgLSBpKTsK
KwkJbGVuID0gc3Rybl9sZW4oJnVzZXJfYnVmZmVyW2ldLCBtYXgpOwogCQlpZiAobGVuIDwgMCkK
IAkJCXJldHVybiBsZW47CiAKQEAgLTE0NzQsNyArMTUwOSw4IEBAIHN0YXRpYyBzc2l6ZV90IHBr
dGdlbl9pZl93cml0ZShzdHJ1Y3QgZmlsZSAqZmlsZSwKIAkJcmV0dXJuIGNvdW50OwogCX0KIAlp
ZiAoIXN0cmNtcChuYW1lLCAiZHN0Nl9tYXgiKSkgewotCQlsZW4gPSBzdHJuX2xlbigmdXNlcl9i
dWZmZXJbaV0sIHNpemVvZihidWYpIC0gMSk7CisJCW1heCA9IG1pbihzaXplb2YoYnVmKSAtIDEs
IGNvdW50IC0gaSk7CisJCWxlbiA9IHN0cm5fbGVuKCZ1c2VyX2J1ZmZlcltpXSwgbWF4KTsKIAkJ
aWYgKGxlbiA8IDApCiAJCQlyZXR1cm4gbGVuOwogCkBAIC0xNDk1LDcgKzE1MzEsOCBAQCBzdGF0
aWMgc3NpemVfdCBwa3RnZW5faWZfd3JpdGUoc3RydWN0IGZpbGUgKmZpbGUsCiAJCXJldHVybiBj
b3VudDsKIAl9CiAJaWYgKCFzdHJjbXAobmFtZSwgInNyYzYiKSkgewotCQlsZW4gPSBzdHJuX2xl
bigmdXNlcl9idWZmZXJbaV0sIHNpemVvZihidWYpIC0gMSk7CisJCW1heCA9IG1pbihzaXplb2Yo
YnVmKSAtIDEsIGNvdW50IC0gaSk7CisJCWxlbiA9IHN0cm5fbGVuKCZ1c2VyX2J1ZmZlcltpXSwg
bWF4KTsKIAkJaWYgKGxlbiA8IDApCiAJCQlyZXR1cm4gbGVuOwogCkBAIC0xNTE4LDcgKzE1NTUs
OCBAQCBzdGF0aWMgc3NpemVfdCBwa3RnZW5faWZfd3JpdGUoc3RydWN0IGZpbGUgKmZpbGUsCiAJ
CXJldHVybiBjb3VudDsKIAl9CiAJaWYgKCFzdHJjbXAobmFtZSwgInNyY19taW4iKSkgewotCQls
ZW4gPSBzdHJuX2xlbigmdXNlcl9idWZmZXJbaV0sIHNpemVvZihwa3RfZGV2LT5zcmNfbWluKSAt
IDEpOworCQltYXggPSBtaW4oc2l6ZW9mKHBrdF9kZXYtPnNyY19taW4pIC0gMSwgY291bnQgLSBp
KTsKKwkJbGVuID0gc3Rybl9sZW4oJnVzZXJfYnVmZmVyW2ldLCBtYXgpOwogCQlpZiAobGVuIDwg
MCkKIAkJCXJldHVybiBsZW47CiAKQEAgLTE1MzgsNyArMTU3Niw4IEBAIHN0YXRpYyBzc2l6ZV90
IHBrdGdlbl9pZl93cml0ZShzdHJ1Y3QgZmlsZSAqZmlsZSwKIAkJcmV0dXJuIGNvdW50OwogCX0K
IAlpZiAoIXN0cmNtcChuYW1lLCAic3JjX21heCIpKSB7Ci0JCWxlbiA9IHN0cm5fbGVuKCZ1c2Vy
X2J1ZmZlcltpXSwgc2l6ZW9mKHBrdF9kZXYtPnNyY19tYXgpIC0gMSk7CisJCW1heCA9IG1pbihz
aXplb2YocGt0X2Rldi0+c3JjX21heCkgLSAxLCBjb3VudCAtIGkpOworCQlsZW4gPSBzdHJuX2xl
bigmdXNlcl9idWZmZXJbaV0sIG1heCk7CiAJCWlmIChsZW4gPCAwKQogCQkJcmV0dXJuIGxlbjsK
IApAQCAtMTU1OCw3ICsxNTk3LDggQEAgc3RhdGljIHNzaXplX3QgcGt0Z2VuX2lmX3dyaXRlKHN0
cnVjdCBmaWxlICpmaWxlLAogCQlyZXR1cm4gY291bnQ7CiAJfQogCWlmICghc3RyY21wKG5hbWUs
ICJkc3RfbWFjIikpIHsKLQkJbGVuID0gc3Rybl9sZW4oJnVzZXJfYnVmZmVyW2ldLCBzaXplb2Yo
dmFsc3RyKSAtIDEpOworCQltYXggPSBtaW4oc2l6ZW9mKHZhbHN0cikgLSAxLCBjb3VudCAtIGkp
OworCQlsZW4gPSBzdHJuX2xlbigmdXNlcl9idWZmZXJbaV0sIG1heCk7CiAJCWlmIChsZW4gPCAw
KQogCQkJcmV0dXJuIGxlbjsKIApAQCAtMTU3NSw3ICsxNjE1LDggQEAgc3RhdGljIHNzaXplX3Qg
cGt0Z2VuX2lmX3dyaXRlKHN0cnVjdCBmaWxlICpmaWxlLAogCQlyZXR1cm4gY291bnQ7CiAJfQog
CWlmICghc3RyY21wKG5hbWUsICJzcmNfbWFjIikpIHsKLQkJbGVuID0gc3Rybl9sZW4oJnVzZXJf
YnVmZmVyW2ldLCBzaXplb2YodmFsc3RyKSAtIDEpOworCQltYXggPSBtaW4oc2l6ZW9mKHZhbHN0
cikgLSAxLCBjb3VudCAtIGkpOworCQlsZW4gPSBzdHJuX2xlbigmdXNlcl9idWZmZXJbaV0sIG1h
eCk7CiAJCWlmIChsZW4gPCAwKQogCQkJcmV0dXJuIGxlbjsKIApAQCAtMTU5OSw3ICsxNjQwLDgg
QEAgc3RhdGljIHNzaXplX3QgcGt0Z2VuX2lmX3dyaXRlKHN0cnVjdCBmaWxlICpmaWxlLAogCX0K
IAogCWlmICghc3RyY21wKG5hbWUsICJmbG93cyIpKSB7Ci0JCWxlbiA9IG51bV9hcmcoJnVzZXJf
YnVmZmVyW2ldLCBERUNfMTBfRElHSVRTLCAmdmFsdWUpOworCQltYXggPSBtaW4oREVDXzEwX0RJ
R0lUUywgY291bnQgLSBpKTsKKwkJbGVuID0gbnVtX2FyZygmdXNlcl9idWZmZXJbaV0sIG1heCwg
JnZhbHVlKTsKIAkJaWYgKGxlbiA8IDApCiAJCQlyZXR1cm4gbGVuOwogCkBAIC0xNjEzLDcgKzE2
NTUsOCBAQCBzdGF0aWMgc3NpemVfdCBwa3RnZW5faWZfd3JpdGUoc3RydWN0IGZpbGUgKmZpbGUs
CiAJfQogI2lmZGVmIENPTkZJR19YRlJNCiAJaWYgKCFzdHJjbXAobmFtZSwgInNwaSIpKSB7Ci0J
CWxlbiA9IG51bV9hcmcoJnVzZXJfYnVmZmVyW2ldLCBERUNfMTBfRElHSVRTLCAmdmFsdWUpOwor
CQltYXggPSBtaW4oREVDXzEwX0RJR0lUUywgY291bnQgLSBpKTsKKwkJbGVuID0gbnVtX2FyZygm
dXNlcl9idWZmZXJbaV0sIG1heCwgJnZhbHVlKTsKIAkJaWYgKGxlbiA8IDApCiAJCQlyZXR1cm4g
bGVuOwogCkBAIC0xNjI0LDcgKzE2NjcsOCBAQCBzdGF0aWMgc3NpemVfdCBwa3RnZW5faWZfd3Jp
dGUoc3RydWN0IGZpbGUgKmZpbGUsCiAJfQogI2VuZGlmCiAJaWYgKCFzdHJjbXAobmFtZSwgImZs
b3dsZW4iKSkgewotCQlsZW4gPSBudW1fYXJnKCZ1c2VyX2J1ZmZlcltpXSwgREVDXzEwX0RJR0lU
UywgJnZhbHVlKTsKKwkJbWF4ID0gbWluKERFQ18xMF9ESUdJVFMsIGNvdW50IC0gaSk7CisJCWxl
biA9IG51bV9hcmcoJnVzZXJfYnVmZmVyW2ldLCBtYXgsICZ2YWx1ZSk7CiAJCWlmIChsZW4gPCAw
KQogCQkJcmV0dXJuIGxlbjsKIApAQCAtMTYzNSw3ICsxNjc5LDggQEAgc3RhdGljIHNzaXplX3Qg
cGt0Z2VuX2lmX3dyaXRlKHN0cnVjdCBmaWxlICpmaWxlLAogCX0KIAogCWlmICghc3RyY21wKG5h
bWUsICJxdWV1ZV9tYXBfbWluIikpIHsKLQkJbGVuID0gbnVtX2FyZygmdXNlcl9idWZmZXJbaV0s
IERFQ181X0RJR0lUUywgJnZhbHVlKTsKKwkJbWF4ID0gbWluKERFQ181X0RJR0lUUywgY291bnQg
LSBpKTsKKwkJbGVuID0gbnVtX2FyZygmdXNlcl9idWZmZXJbaV0sIG1heCwgJnZhbHVlKTsKIAkJ
aWYgKGxlbiA8IDApCiAJCQlyZXR1cm4gbGVuOwogCkBAIC0xNjQ2LDcgKzE2OTEsOCBAQCBzdGF0
aWMgc3NpemVfdCBwa3RnZW5faWZfd3JpdGUoc3RydWN0IGZpbGUgKmZpbGUsCiAJfQogCiAJaWYg
KCFzdHJjbXAobmFtZSwgInF1ZXVlX21hcF9tYXgiKSkgewotCQlsZW4gPSBudW1fYXJnKCZ1c2Vy
X2J1ZmZlcltpXSwgREVDXzVfRElHSVRTLCAmdmFsdWUpOworCQltYXggPSBtaW4oREVDXzVfRElH
SVRTLCBjb3VudCAtIGkpOworCQlsZW4gPSBudW1fYXJnKCZ1c2VyX2J1ZmZlcltpXSwgbWF4LCAm
dmFsdWUpOwogCQlpZiAobGVuIDwgMCkKIAkJCXJldHVybiBsZW47CiAKQEAgLTE2NTksNyArMTcw
NSw4IEBAIHN0YXRpYyBzc2l6ZV90IHBrdGdlbl9pZl93cml0ZShzdHJ1Y3QgZmlsZSAqZmlsZSwK
IAlpZiAoIXN0cmNtcChuYW1lLCAibXBscyIpKSB7CiAJCXVuc2lnbmVkIGludCBuLCBjbnQ7CiAK
LQkJbGVuID0gZ2V0X2xhYmVscygmdXNlcl9idWZmZXJbaV0sIHBrdF9kZXYpOworCQltYXggPSBj
b3VudCAtIGk7CisJCWxlbiA9IGdldF9sYWJlbHMoJnVzZXJfYnVmZmVyW2ldLCBtYXgsIHBrdF9k
ZXYpOwogCQlpZiAobGVuIDwgMCkKIAkJCXJldHVybiBsZW47CiAJCWkgKz0gbGVuOwpAQCAtMTY4
MCw3ICsxNzI3LDggQEAgc3RhdGljIHNzaXplX3QgcGt0Z2VuX2lmX3dyaXRlKHN0cnVjdCBmaWxl
ICpmaWxlLAogCX0KIAogCWlmICghc3RyY21wKG5hbWUsICJ2bGFuX2lkIikpIHsKLQkJbGVuID0g
bnVtX2FyZygmdXNlcl9idWZmZXJbaV0sIERFQ180X0RJR0lUUywgJnZhbHVlKTsKKwkJbWF4ID0g
bWluKERFQ180X0RJR0lUUywgY291bnQgLSBpKTsKKwkJbGVuID0gbnVtX2FyZygmdXNlcl9idWZm
ZXJbaV0sIG1heCwgJnZhbHVlKTsKIAkJaWYgKGxlbiA8IDApCiAJCQlyZXR1cm4gbGVuOwogCkBA
IC0xNzA3LDcgKzE3NTUsOCBAQCBzdGF0aWMgc3NpemVfdCBwa3RnZW5faWZfd3JpdGUoc3RydWN0
IGZpbGUgKmZpbGUsCiAJfQogCiAJaWYgKCFzdHJjbXAobmFtZSwgInZsYW5fcCIpKSB7Ci0JCWxl
biA9IG51bV9hcmcoJnVzZXJfYnVmZmVyW2ldLCBERUNfMV9ESUdJVFMsICZ2YWx1ZSk7CisJCW1h
eCA9IG1pbihERUNfMV9ESUdJVFMsIGNvdW50IC0gaSk7CisJCWxlbiA9IG51bV9hcmcoJnVzZXJf
YnVmZmVyW2ldLCBtYXgsICZ2YWx1ZSk7CiAJCWlmIChsZW4gPCAwKQogCQkJcmV0dXJuIGxlbjsK
IApAQCAtMTcyMiw3ICsxNzcxLDggQEAgc3RhdGljIHNzaXplX3QgcGt0Z2VuX2lmX3dyaXRlKHN0
cnVjdCBmaWxlICpmaWxlLAogCX0KIAogCWlmICghc3RyY21wKG5hbWUsICJ2bGFuX2NmaSIpKSB7
Ci0JCWxlbiA9IG51bV9hcmcoJnVzZXJfYnVmZmVyW2ldLCBERUNfMV9ESUdJVFMsICZ2YWx1ZSk7
CisJCW1heCA9IG1pbihERUNfMV9ESUdJVFMsIGNvdW50IC0gaSk7CisJCWxlbiA9IG51bV9hcmco
JnVzZXJfYnVmZmVyW2ldLCBtYXgsICZ2YWx1ZSk7CiAJCWlmIChsZW4gPCAwKQogCQkJcmV0dXJu
IGxlbjsKIApAQCAtMTczNyw3ICsxNzg3LDggQEAgc3RhdGljIHNzaXplX3QgcGt0Z2VuX2lmX3dy
aXRlKHN0cnVjdCBmaWxlICpmaWxlLAogCX0KIAogCWlmICghc3RyY21wKG5hbWUsICJzdmxhbl9p
ZCIpKSB7Ci0JCWxlbiA9IG51bV9hcmcoJnVzZXJfYnVmZmVyW2ldLCBERUNfNF9ESUdJVFMsICZ2
YWx1ZSk7CisJCW1heCA9IG1pbihERUNfNF9ESUdJVFMsIGNvdW50IC0gaSk7CisJCWxlbiA9IG51
bV9hcmcoJnVzZXJfYnVmZmVyW2ldLCBtYXgsICZ2YWx1ZSk7CiAJCWlmIChsZW4gPCAwKQogCQkJ
cmV0dXJuIGxlbjsKIApAQCAtMTc2NCw3ICsxODE1LDggQEAgc3RhdGljIHNzaXplX3QgcGt0Z2Vu
X2lmX3dyaXRlKHN0cnVjdCBmaWxlICpmaWxlLAogCX0KIAogCWlmICghc3RyY21wKG5hbWUsICJz
dmxhbl9wIikpIHsKLQkJbGVuID0gbnVtX2FyZygmdXNlcl9idWZmZXJbaV0sIERFQ18xX0RJR0lU
UywgJnZhbHVlKTsKKwkJbWF4ID0gbWluKERFQ18xX0RJR0lUUywgY291bnQgLSBpKTsKKwkJbGVu
ID0gbnVtX2FyZygmdXNlcl9idWZmZXJbaV0sIG1heCwgJnZhbHVlKTsKIAkJaWYgKGxlbiA8IDAp
CiAJCQlyZXR1cm4gbGVuOwogCkBAIC0xNzc5LDcgKzE4MzEsOCBAQCBzdGF0aWMgc3NpemVfdCBw
a3RnZW5faWZfd3JpdGUoc3RydWN0IGZpbGUgKmZpbGUsCiAJfQogCiAJaWYgKCFzdHJjbXAobmFt
ZSwgInN2bGFuX2NmaSIpKSB7Ci0JCWxlbiA9IG51bV9hcmcoJnVzZXJfYnVmZmVyW2ldLCBERUNf
MV9ESUdJVFMsICZ2YWx1ZSk7CisJCW1heCA9IG1pbihERUNfMV9ESUdJVFMsIGNvdW50IC0gaSk7
CisJCWxlbiA9IG51bV9hcmcoJnVzZXJfYnVmZmVyW2ldLCBtYXgsICZ2YWx1ZSk7CiAJCWlmIChs
ZW4gPCAwKQogCQkJcmV0dXJuIGxlbjsKIApAQCAtMTc5NSw3ICsxODQ4LDkgQEAgc3RhdGljIHNz
aXplX3QgcGt0Z2VuX2lmX3dyaXRlKHN0cnVjdCBmaWxlICpmaWxlLAogCiAJaWYgKCFzdHJjbXAo
bmFtZSwgInRvcyIpKSB7CiAJCV9fdTMyIHRtcF92YWx1ZTsKLQkJbGVuID0gaGV4MzJfYXJnKCZ1
c2VyX2J1ZmZlcltpXSwgSEVYXzJfRElHSVRTLCAmdG1wX3ZhbHVlKTsKKworCQltYXggPSBtaW4o
SEVYXzJfRElHSVRTLCBjb3VudCAtIGkpOworCQlsZW4gPSBoZXgzMl9hcmcoJnVzZXJfYnVmZmVy
W2ldLCBtYXgsICZ0bXBfdmFsdWUpOwogCQlpZiAobGVuIDwgMCkKIAkJCXJldHVybiBsZW47CiAK
QEAgLTE4MTEsNyArMTg2Niw5IEBAIHN0YXRpYyBzc2l6ZV90IHBrdGdlbl9pZl93cml0ZShzdHJ1
Y3QgZmlsZSAqZmlsZSwKIAogCWlmICghc3RyY21wKG5hbWUsICJ0cmFmZmljX2NsYXNzIikpIHsK
IAkJX191MzIgdG1wX3ZhbHVlOwotCQlsZW4gPSBoZXgzMl9hcmcoJnVzZXJfYnVmZmVyW2ldLCBI
RVhfMl9ESUdJVFMsICZ0bXBfdmFsdWUpOworCisJCW1heCA9IG1pbihIRVhfMl9ESUdJVFMsIGNv
dW50IC0gaSk7CisJCWxlbiA9IGhleDMyX2FyZygmdXNlcl9idWZmZXJbaV0sIG1heCwgJnRtcF92
YWx1ZSk7CiAJCWlmIChsZW4gPCAwKQogCQkJcmV0dXJuIGxlbjsKIApAQCAtMTgyNiw3ICsxODgz
LDggQEAgc3RhdGljIHNzaXplX3QgcGt0Z2VuX2lmX3dyaXRlKHN0cnVjdCBmaWxlICpmaWxlLAog
CX0KIAogCWlmICghc3RyY21wKG5hbWUsICJza2JfcHJpb3JpdHkiKSkgewotCQlsZW4gPSBudW1f
YXJnKCZ1c2VyX2J1ZmZlcltpXSwgREVDXzlfRElHSVRTLCAmdmFsdWUpOworCQltYXggPSBtaW4o
REVDXzlfRElHSVRTLCBjb3VudCAtIGkpOworCQlsZW4gPSBudW1fYXJnKCZ1c2VyX2J1ZmZlcltp
XSwgbWF4LCAmdmFsdWUpOwogCQlpZiAobGVuIDwgMCkKIAkJCXJldHVybiBsZW47CiAKLS0gCjIu
NDguMQoK

